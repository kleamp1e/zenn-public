---
title: "EfficientNet B0〜B7で分類器を転移学習してみる"
emoji: "🎓"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["machinelearning", "deeplearning", "computervision", "python", "keras"]
published: false
---

# はじめに

「[けしからん画像分類器を作ってみる](202102-pornography-classifier-1)」シリーズで、画像分類モデルとしてEfficientNetを使ってみました。
今回はEfficientNetのバリエーションであるB0〜B7について、実際に学習を行って、実例での相違を見ていきます。

# データ

使用した画像データには2つのラベル（`0`と`1`）が付けられており、学習データ、検証データ、テストデータは8:1:1の比率に近づくようにハッシュ値ベースで切り出しています。
また、検証データ、テストデータについてはラベル数が一致するように調整しています。

データ数は以下の通りです。

| 種別 | ラベル`0` | ラベル`1` | 合計 |
|:---|---:|---:|---:|
| 学習データ | 6,126 | 13,532 | 19,658 |
| 検証データ | 747 | 747 | 1,494 |
| テストデータ | 744 | 744 | 1,488 |
| 合計 | 7,617 | 15,023 | 22,640 |

# 環境

使用した環境は以下の通りです。学習はDockerコンテナ内で実施しています。

* ハードウェア:
    * CPU: AMD Ryzen 7 3700X（8コア/16スレッド）
    * メモリ: 64GB
    * GPU: GeForce GTX 1070（メモリ8GB）
* ソフトウェア:
    * OS: Ubuntu 20.04.2 LTS
    * Docker: 19.03.8
    * NVIDIAドライバ: 460.39
    * Dockerコンテナ内:
        * CUDA: 11.0.3
        * cuDNN: 8
        * Python: 3.8.5
        * TensorFlow: 2.4.1

# フレームワーク

機械学習種レームワークとしては「Keras」を使用しました。
Kerasでは、TensorFlow Hubから取得したEfficientNetの学習済みモデルを簡単に使うことができます。

# 学習結果


# 学習処理
