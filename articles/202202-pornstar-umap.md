---
title: "セクシー女優の顔特徴量をUMAPで次元削減、クラスタリングしてみた"
emoji: "👙"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["machinelearning", "deeplearning", "computervision", "python", "UMAP"]
published: true
---

# 目次

1. [画像からセクシー女優を検索するツールを実装してみた](202202-pornstar-recognizer)
2. セクシー女優の顔特徴量をUMAPで次元削減、クラスタリングしてみた（本記事）

# はじめに

前回の記事『[画像からセクシー女優を検索するツールを実装してみた](202202-pornstar-recognizer)』では、InsightFaceを使い、画像から顔検出、顔認証を行って、類似するセクシー女優を検索できるようにしてみました。

今回はその顔特徴量データ（1,000人、5,000枚分）を使って、次元削減、クラスタリングの実験をしてみました。

実験はGoogle Colaboratory上で行いました。ノートブックは以下の通りです。
今回、初めてGoogle Colaboratoryを使いました。とても便利ですね。

https://colab.research.google.com/drive/1Cd8WyLDJB_EHSh1m5kKOrNV9TQWKBZst?usp=sharing

# 何のために次元削減、クラスタリングするの？

顔特徴量のデータは512次元で構成されています。
「異常な（他人の）顔特徴量が含まれているか？」、「誰と誰が似ているか？」といった分析を行いたいのですが、次元数が高いと直感的に取り扱うのが難しいので、3次元、2次元などの低次元で表現できると便利です。

今回は「UMAPを使ってみる」のが目的だったので、実は上記の目的は後付けだったりします。

# 何を使うの？UMAPとは？

「次元削減」と聞くと、t-SNEを思い浮かべる方が多いかと思います。つい最近、「[UMAP](https://umap-learn.readthedocs.io/en/latest/)」というライブラリの存在を知りました。

t-SNEと比べてUMAPの利点は、

* 結果が安定している。（再実行すると近しい結果を得られる）
* 新たなデータも写像できる。
* 逆写像できる。

などがあります。詳しくは公式ドキュメントを参照ください。

# コード例

## 教師あり

## 教師なし

# 最後に
